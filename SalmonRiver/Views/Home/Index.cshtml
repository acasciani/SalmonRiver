@model SalmonRiver.Models.BookNowViewModel

@{
    ViewBag.Title = "Welcome";
    ViewBag.HasHeaderCarousel = true;
    ViewBag.ActiveHeader = "Home";

    string errorMessage;

    bool startDateError = false;
    bool endDateError = false;
    bool guestsError = false;

    switch ((Errors?)ViewBag.ErrorCode)
    {
        case Errors.BookNow_InvalidStartOrEndDate:
            startDateError = true;
            endDateError = true;
            errorMessage = "Please select a valid start and end from the available dates.";
            
            break;
            
        case Errors.BookNow_SelectedDatesOnHold: 
            startDateError = true;
            endDateError = true;
            errorMessage = "One or more of the dates you selected are unavailable at the moment. Please try again a little later."; 
            break;
            
        case Errors.BookNow_SomeDatesUnavailable: 
            startDateError = true;
            endDateError = true;
            errorMessage = "Some of the dates you selected are no longer available."; 
            break;
            
        case Errors.BookNow_InvalidGuestSelection:
            guestsError = true;
            errorMessage = "The number of selected guests is invalid. Please select how many guests will be attending.";
            break;
            
        case Errors.BookNow_OtherError:
            guestsError = true;
            startDateError = true;
            endDateError = true;
            errorMessage = "An error occurred. Please make sure you select a start date, end date and the number of guests.";
            break;
            
        default: errorMessage = null; break;
    }
}

@section styles {
    <style type="text/css">
        .header-site {
            margin-bottom: -70px;
        }
    </style>
}

@section scripts {
    <script src="/Scripts/custom/HeaderNavBar.js"></script>

    <script>
        var availableDates = [];
        @foreach (var availableDate in ViewBag.AvailableDates)
        {
            @:availableDates.push("@string.Format("{0:MM/dd/yyyy}", availableDate)");
        }

        $('#startDate').datetimepicker({ format: 'MM/DD/YYYY', enabledDates: availableDates });
        $('#endDate').datetimepicker({
            useCurrent: false, //Important! See issue #1075
            format: 'MM/DD/YYYY',
            enabledDates: availableDates
        });

        $("#startDate").on("dp.change", function (e) {
            $('#endDate').data("DateTimePicker").minDate(e.date);
        });
        $("#endDate").on("dp.change", function (e) {
            $('#startDate').data("DateTimePicker").maxDate(e.date);
        });
    </script>

}

@using(Html.BeginForm())
{ 
<div class="booknow">
    <div class="container">
        <h3><label>Book Your Reservation Now</label></h3>

        <div class="row">
            @if (!string.IsNullOrWhiteSpace(errorMessage))
            {
                <div class="col-sm-12">
                    <p class="text-danger" style="font-weight: bold;">
                        @errorMessage
                    </p>
                </div>
            }

            <div class="col-sm-12">
                <div class="form-horizontal">

                    <div class='col-xs-5 col-sm-3'>
                        <div class="@(!startDateError ? "form-group" : "form-group has-error has-feedback")">
                            <div class='input-group date' id='startDate'>
                                @Html.TextBoxFor(i=> i.Start, new { @class = "form-control", placeholder="Start" })
                                <span class="input-group-addon">
                                    <span class="glyphicon glyphicon-calendar"></span>
                                </span>
                            </div>
                        </div>
                    </div>
                    <label class="control-label col-xs-2 col-sm-1" style="text-align: center">to</label>
                    <div class='col-xs-5 col-sm-3'>
                        <div class="@(!endDateError ? "form-group" : "form-group has-error has-feedback")">
                            <div class='input-group date' id='endDate'>
                                @Html.TextBoxFor(i => i.End, new { @class = "form-control", placeholder = "End" })
                                <span class="input-group-addon">
                                    <span class="glyphicon glyphicon-calendar"></span>
                                </span>
                            </div>
                        </div>

                    </div>
                    <div class="col-sm-2 col-xs-5 col-sm-offset-1">
                        <div class="@(!guestsError ? "form-group" : "form-group has-error has-feedback")">
                            @Html.DropDownListFor(i => i.Guests, new List<SelectListItem>() { 
                           new SelectListItem() { Text = "# of guests" },
                           new SelectListItem() { Text = "1 guest", Value = "1" }, 
                           new SelectListItem() { Text = "2 guests", Value = "2" }, 
                           new SelectListItem() { Text = "3 guests", Value = "3" }, 
                           new SelectListItem() { Text = "4 guests", Value = "4" }, 
                           new SelectListItem() { Text = "5 guests", Value = "5" }, 
                           new SelectListItem() { Text = "6 guests", Value = "6" } }, new { @class = "form-control" })
                        </div>
                    </div>

                    <div class="col-sm-2 col-xs-7" style="text-align: right">
                        <div class="form-group">
                            <button type="submit" class="btn btn-primary" onclick="return ">Book&nbsp;&nbsp;&#10097;&#10097;</button>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>
}

<div class="container">
    <div class="row">

        <div class="col-sm-8">
            <h1>Headwaters Cabins at the Salmon River</h1>
            <p>Just steps from the headwaters of the Salmon River enjoy your stay in this new cabin that sleeps 4-6 and is fully equipped with all amenities. All amenities include new kitchen appliance, TV, bath and a half and gas stove for those chilly nights. The snowmobile trail is just around the corner and fishing access to the Salmon River is across the road at the headwaters.</p>
            <p>This area has it all. Fishing, snowmobiling, hiking, ATV, skiing or just a place to relax and enjoy nature. Located just outside the village of Altmar, New York this cabin is in the heart of Salomon fishing for the expert or the novice!</p>
            <p>And while you are here visit the Salmon River Fish Hatchery, the state’s largest hatchery, maintained by the Department of Environmental Conservation just down the road!</p>
        </div>

        <div class="col-sm-4 hidden-xs" style="margin-top:20px;">
            <img src="~/Content/images/twitter-example.png" width="100%" />
        </div>

    </div>

    <div class="row">


        <div class="col-sm-4">
            <a href="http://www.dec.ny.gov/outdoor/21663.html">
                <div class="panel panel-default book-now" style="margin-top: 20px; border-bottom-right-radius: 0; border-bottom-left-radius: 0;">
                    <div class="panel-heading" style="background-image: url(/Content/images/SalmonRiverFishHatchery.jpg); background-repeat: no-repeat; background-size: contain;background-position: center bottom; ">
                        <img src="/Content/images/SalmonRiverFishHatchery.jpg" style="visibility: hidden;" width="100%" />
                    </div>
                    <div class="panel-body">
                        <div class="pull-left"><strong>Salmon River Fish Hatchery</strong></div>
                        <div class="pull-right"><span class="glyphicon glyphicon-circle-arrow-right"></span></div>
                    </div>
                </div>
            </a>
        </div>

        <div class="col-sm-4">
            <a href="http://www.visitoswegocounty.com/snowmobile/">
                <div class="panel panel-default book-now" style="margin-top: 20px; border-bottom-right-radius: 0; border-bottom-left-radius: 0;">
                    <div class="panel-heading" style="background-image: url(/Content/images/snowmobiling.jpg); background-repeat: no-repeat; background-size: contain;background-position: center bottom; ">
                        <img src="/Content/images/snowmobiling.jpg" style="visibility: hidden;" width="100%" />
                    </div>
                    <div class="panel-body">
                        <div class="pull-left"><strong>Snowmobiling Trails</strong></div>
                        <div class="pull-right"><span class="glyphicon glyphicon-circle-arrow-right"></span></div>
                    </div>
                </div>
            </a>
        </div>

        <div class="col-sm-4">
            <a href="http://visitoswegocounty.com/the-great-outdoors/cross-country-skiing-snowshoeing/">
                <div class="panel panel-default book-now" style="margin-top: 20px; border-bottom-right-radius: 0; border-bottom-left-radius: 0;">
                    <div class="panel-heading" style="background-image: url(/Content/images/skiing.jpg); background-repeat: no-repeat; background-size: contain;background-position: center bottom; ">
                        <img src="/Content/images/skiing.jpg" style="visibility: hidden;" width="100%" />
                    </div>
                    <div class="panel-body">
                        <div class="pull-left"><strong>Ski Trails</strong></div>
                        <div class="pull-right"><span class="glyphicon glyphicon-circle-arrow-right"></span></div>
                    </div>
                </div>
            </a>
        </div>

        <div class="col-sm-4">
            <a href="http://www.oswegocountyatv.org/">
                <div class="panel panel-default book-now" style="margin-top: 20px; border-bottom-right-radius: 0; border-bottom-left-radius: 0;">
                    <div class="panel-heading" style="background-image: url(/Content/images/atv.jpg); background-repeat: no-repeat; background-size: contain;background-position: center bottom; ">
                        <img src="/Content/images/atv.jpg" style="visibility: hidden;" width="100%" />
                    </div>
                    <div class="panel-body">
                        <div class="pull-left"><strong>ATV Trails</strong></div>
                        <div class="pull-right"><span class="glyphicon glyphicon-circle-arrow-right"></span></div>
                    </div>
                </div>
            </a>
        </div>

        <div class="col-sm-4">
            <a href="http://oswegocounty.maps.arcgis.com/apps/MapTour/index.html?appid=af44af41ab5642d7958e229a61bfceb0">
                <div class="panel panel-default book-now" style="margin-top: 20px; border-bottom-right-radius: 0; border-bottom-left-radius: 0;">
                    <div class="panel-heading" style="background-image: url(/Content/images/nature.jpg); background-repeat: no-repeat; background-size: contain;background-position: center bottom; ">
                        <img src="/Content/images/nature.jpg" style="visibility: hidden;" width="100%" />
                    </div>
                    <div class="panel-body">
                        <div class="pull-left"><strong>Nature Views</strong></div>
                        <div class="pull-right"><span class="glyphicon glyphicon-circle-arrow-right"></span></div>
                    </div>
                </div>
            </a>
        </div>

        <div class="col-sm-4">
            <a href="http://oswegocounty.maps.arcgis.com/apps/MapTour/index.html?appid=af44af41ab5642d7958e229a61bfceb0">
                <div class="panel panel-default book-now" style="margin-top: 20px; border-bottom-right-radius: 0; border-bottom-left-radius: 0;">
                    <div class="panel-heading" style="background-image: url(/Content/images/hiking.jpg); background-repeat: no-repeat; background-size: contain;background-position: center bottom; ">
                        <img src="/Content/images/hiking.jpg" style="visibility: hidden;" width="100%" />
                    </div>
                    <div class="panel-body">
                        <div class="pull-left"><strong>Hiking Trails</strong></div>
                        <div class="pull-right"><span class="glyphicon glyphicon-circle-arrow-right"></span></div>
                    </div>
                </div>
            </a>
        </div>
    </div>
</div>